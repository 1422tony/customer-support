<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta property="og:title" content="é ‚ç´šé–‹ç™¼è€…æ©Ÿæ¢°éµç›¤ (æ¸¬è©¦å•†å“)">
    <meta property="og:image" content="https://placehold.co/600x400/0084ff/ffffff?text=Keyboard+Product">
    
    <title>å®¢æœç³»çµ±æ¸¬è©¦é é¢ (V28.0 æ¨¡æ“¬ç’°å¢ƒ)</title>
    <style>
        body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; padding: 0; background-color: #f0f2f5; }
        .container { max-width: 800px; margin: 50px auto; padding: 30px; background: white; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h1 { color: #333; margin-top: 0; }
        p { line-height: 1.6; color: #666; }
        
        .product-card { border: 1px solid #eee; padding: 20px; border-radius: 12px; margin-top: 20px; display: flex; align-items: center; gap: 20px; background: #fafafa; }
        .product-img { width: 120px; height: 120px; border-radius: 8px; object-fit: cover; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        .btn { padding: 12px 24px; background: #0084ff; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 16px; transition: 0.2s; }
        .btn:hover { background: #006ecd; }
        
        /* æç¤ºå€å¡Š */
        .notice { background: #fff3cd; color: #856404; padding: 15px; border-radius: 6px; margin-bottom: 20px; font-size: 14px; border: 1px solid #ffeeba; line-height: 1.5; }
        code { background: #f8f9fa; padding: 2px 5px; border-radius: 3px; color: #e83e8c; font-family: monospace; }
        
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 20px; background: #f1f1f1; padding: 15px; border-radius: 8px;}
        .info-item { font-size: 13px; color: #555; }
        .info-item span { font-weight: bold; color: #333; }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ›’ é–‹ç™¼æ¸¬è©¦å°ˆç”¨åº—</h1>
        
        <div class="notice">
            <strong>âš ï¸ é–‹ç™¼è€…æ³¨æ„ï¼š</strong><br>
            æ­¤é é¢æ¨¡æ“¬ <strong>V28.0 ç©©å®šç‰ˆ</strong> çš„é‹ä½œé‚è¼¯ã€‚<br>
            åŒ…å«ï¼šSessionStorage å‚³éå•†å“ã€UserProfile å‚³éåœ°å€èˆ‡è³¼ç‰©è»Šé‡‘é¡ã€‚<br>
            è«‹ç¢ºèªä¸‹æ–¹çš„ <code>secretKey</code> èˆ‡æ‚¨ <code>server.js</code> å…§çš„è¨­å®šä¸€è‡´ï¼
        </div>

        <div class="product-card">
            <img src="https://placehold.co/600x400/0084ff/ffffff?text=Keyboard+Product" class="product-img" alt="å•†å“åœ–">
            
            <div>
                <h3 style="margin: 0 0 10px 0;">é ‚ç´šé–‹ç™¼è€…æ©Ÿæ¢°éµç›¤</h3>
                <p style="margin: 0 0 15px 0;">é€™æ˜¯ä¸€å€‹æ¨¡æ“¬å•†å“é ï¼ŒWidget æœƒè‡ªå‹•æŠ“å–æ¨™é¡Œå‚³å›å¾Œå° (ä¸å«åœ–ç‰‡)ã€‚</p>
                <p style="color: #e74c3c; font-weight: bold; font-size: 1.2em;">$4,999</p>
                <button class="btn" onclick="alert('é€™åªæ˜¯æ¨¡æ“¬é é¢ï¼Œè«‹è§€å¯Ÿå³ä¸‹è§’ Widget')">åŠ å…¥è³¼ç‰©è»Š</button>
            </div>
        </div>

        <div class="info-grid">
            <div class="info-item"><span>æ¨¡æ“¬ IDï¼š</span> cb_user_sim_001</div>
            <div class="info-item"><span>æ¨¡æ“¬åœ°å€ï¼š</span> 520 å½°åŒ–ç¸£ ç”°ä¸­é® æ¸¬è©¦è·¯123è™Ÿ</div>
            <div class="info-item"><span>æ¨¡æ“¬é‡‘é¡ï¼š</span> $4,999</div>
            <div class="info-item"><span>æ¨¡æ“¬ç¶²åŸŸï¼š</span> geniusart.cyberbiz.co</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>

    <script>
        // --- æ¨¡æ“¬ç’°å¢ƒåƒæ•¸ ---
        var shopId = "test";
        var token = "9999"; 
        var customerId = "user_sim_001"; // åŸå§‹ ID
        var userId = "cb_" + customerId; // åŠ ä¸Šå‰ç¶´å¾Œçš„ ID
        var userName = "æ¨¡æ“¬å®¢æˆ¶å°æ˜";
        
        // â˜…â˜…â˜… è«‹ç¢ºèªé€™è£¡çš„ Key èˆ‡ server.js ä¸€è‡´ â˜…â˜…â˜…
        var secretKey = "my_super_secret_key_2025"; 
        
        // 1. è¨ˆç®— HMAC ç°½ç«  (æ¨¡æ“¬ Liquid çš„ hmac_sha256)
        var dataToSign = "cb_" + customerId;
        var signature = CryptoJS.HmacSHA256(dataToSign, secretKey).toString(CryptoJS.enc.Hex);
        
        // 2. æ¨¡æ“¬ V28.0 çš„ã€Œéš±å½¢å•†å“å‚³è¼¸ã€
        // ç›´æ¥å¯«å…¥ sessionStorageï¼Œä¸é€éå…¨åŸŸè®Šæ•¸å‚³éï¼Œé¿å… 413 éŒ¯èª¤
        var pData = {
            id: "prod_001",
            title: "é ‚ç´šé–‹ç™¼è€…æ©Ÿæ¢°éµç›¤ (æ¸¬è©¦å•†å“)",
            price: "4999", // ç´”æ•¸å­—
            // image: ... (V28.0 å·²ç§»é™¤åœ–ç‰‡å‚³é€)
            url: window.location.href
        };
        sessionStorage.setItem('cb_current_product', JSON.stringify(pData));

        // 3. æ¨¡æ“¬ V28.0 çš„ UserProfile è³‡æ–™
        var userProfileData = {
            email: "tester@example.com",
            mobile: "0912345678",
            
            // æ¨¡æ“¬åœ°å€ (éƒµéå€è™Ÿ + ç¸£å¸‚ + å€ + è·¯å)
            address: "520 å½°åŒ–ç¸£ ç”°ä¸­é® æ¸¬è©¦è·¯123è™Ÿ",
            
            // æ¨¡æ“¬å•†åº—ç¶²åŸŸ (ç”¨æ–¼å¾Œå°ç”¢ç”Ÿæ­£ç¢ºé€£çµ)
            shopDomain: "geniusart.cyberbiz.co",
            
            totalSpent: "15000",
            tags: "VIP,æ¸¬è©¦å“¡",
            ordersCount: "5",
            acceptsMarketing: "true",
            accountStatus: "enabled",
            riskScore: "0",
            
            // æ¨¡æ“¬è³¼ç‰©è»Š (åªå‚³æ•¸å­—)
            cartTotal: 4999,
            cartCount: 1,
            
            loginType: "æœƒå“¡ç™»å…¥"
        };

        console.log("------------------------------------------------");
        console.log("æ¸¬è©¦ç’°å¢ƒ V28.0 æ¨¡æ“¬æ•¸æ“š:");
        console.log("User ID:", userId);
        console.log("Signature:", signature);
        console.log("Current Product (Session):", pData);
        console.log("User Profile:", userProfileData);
        console.log("------------------------------------------------");

        // 4. åˆå§‹åŒ– Widget Config
        window.ChatWidgetConfig = {
            shopId: shopId,
            token: token,
            userId: userId,
            userName: userName,
            signature: signature,
            userProfile: userProfileData,
            
            // V28.0 ä¸­ï¼ŒcurrentProduct å·²å¾é€™è£¡ç§»é™¤ï¼Œæ”¹ç”± sessionStorage è®€å–

            autoReplyEnabled: true,
            startHour: 9,
            endHour: 18,
            offlineMsg: "é€™æ˜¯æ¸¬è©¦åº—çš„è‡ªå‹•å›å¾©ï¼šç¾åœ¨ä¸‹ç­å›‰ï¼"
        };
    </script>

    <script src="/widget.js" async></script>

</body>
</html>